<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Misc on Zer0d0y(段公子)&#39;s Blog</title>
    <link>https://www.zer0d0y.info/categories/misc/feed/index.xml</link>
    <description>Recent content in Misc on Zer0d0y(段公子)&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-CN</language>
    <copyright>Copyright (c) 2017. All rights reserved.</copyright>
    <atom:link href="https://www.zer0d0y.info/categories/misc/feed/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Ubuntu Server 14.04 LTS  Network Bonding and Restarting Network through SSH</title>
      <link>https://www.zer0d0y.info/post/Ubuntu-Server-14.04-LTS-Network-Bonding-and-Restarting-Network-through-SSH/</link>
      <pubDate>Thu, 16 Mar 2017 22:46:56 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/Ubuntu-Server-14.04-LTS-Network-Bonding-and-Restarting-Network-through-SSH/</guid>
      <description>

&lt;pre&gt;&lt;code&gt;TL;DR - Ubuntu Server 14.04 LTS  networking issue In One Place
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;no1-ubuntu-server-14-04-lts-network-bonding-and-restarting-network-through-ssh&#34;&gt;&lt;strong&gt;NO1：Ubuntu Server 14.04 LTS  Network Bonding and Restarting Network through SSH&lt;/strong&gt;&lt;/h5&gt;

&lt;p&gt;1.配置Network Bonding&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ENV（环境）：
OS：Ubuntu Server 14.04 LTS
ifenslave：2.4ubuntu1.2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;1.）安装ifenslave（Attach and detach slave network devices to a bonding device）&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# apt-get install ifenslave
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;2.）加载bonding模块，使用mode 6&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# modprobe bonding mode=6 miimon=100 

\#（加载模块会加载/etc/network/interfaces配置）
\#（如出现cant‘t find bond0，卸载再重新加载：modprobe -r bonding &amp;amp;&amp;amp; modprobe bonding）

# lsmod | grep bonding

\# 设置开机自动加载
# echo &amp;quot;bonding mode=6 miimon=100&amp;quot; &amp;gt;&amp;gt; /etc/modules &amp;amp;&amp;amp; cat /etc/modules

\#（设置内核模块参数）
# modinfo -p bonding -- 列出模块支持的参数
# modprobe bonding mode=6 miimon=100

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;3.）配置网卡 /etc/network/interfaces&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# cd /root
# cp /etc/network/interfaces etc.network.interfaces
# vi etc.network.interfaces_bond
auto lo
iface lo inet loopback

auto bond0
iface bond0 inet static
address 192.168.190.129
netmask 255.255.255.0
gateway 192.168.190.250

auto bond0:1
iface bond0:1 inet static
address 192.168.2.220
netmask 255.255.255.0

dns-nameserver 114.114.114.114 233.5.5.5
pre-down ifenslave -d bond0 eth0 eth1
post-up ifenslave bond0 eth0 eth1

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;4.）SSH 远程重启网卡/网络&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;方法1：
# screen 
\# 注意命令必须在screen里执行，否则ifdown后面的命令无法执行。
# cp etc.network.interfaces /etc/network/interfaces &amp;amp;&amp;amp; ifdown eth0 &amp;amp;&amp;amp; cp etc.network.interfaces_bond /etc/network/interfaces &amp;amp;&amp;amp; ifup bond0 

\## 特别注意：执行以上命令前，必须先确认接口状态（ifconfig）根据状态使用不同的命令，也要注意管道&amp;amp;&amp;amp;，因为前面命令返回结果可能不为0，但是网卡已经down了。
举例：
接口当前是bond0，UP状态
# bash -c &amp;quot;ifdown bond0 &amp;amp;&amp;amp; modprobe -r bonding &amp;amp;&amp;amp; modprobe bonding&amp;quot;    --- 不成功
# bash -c &amp;quot;ifdown bond0 ;sleep 10  ; modprobe -r bonding &amp;amp;&amp;amp; modprobe bonding&amp;quot;    --- 成功（注意sleep和;的使用）

方法2：
# bash -c &amp;quot;ifdown eth0 &amp;amp;&amp;amp; ifup eth0&amp;quot;
\# 注意bash -c（The solution is to run the command in a new shell）

参考：
http://serverfault.com/questions/278838/restarting-network-through-ssh
http://askubuntu.com/questions/441619/how-to-successfully-restart-a-network-without-reboot-over-ssh

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;5.）修改Bond接口配置（和模块参数），强制重新加载&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;方法1.
# screen
# ifdown -a  ;modprobe -r bonding &amp;amp;&amp;amp; modprobe bonding &amp;amp;&amp;amp; sleep 5 &amp;amp;&amp;amp; ifup -a --force ; ifconfig
# ifdown -a  ;modprobe -r bonding &amp;amp;&amp;amp; modprobe bonding mode=6 &amp;amp;&amp;amp; sleep 5 &amp;amp;&amp;amp; ifup -a --force ; ifconfig  --- （模块参数）

方法2.
# bash -c &amp;quot;ifdown -a  ;modprobe -r bonding &amp;amp;&amp;amp; modprobe bonding &amp;amp;&amp;amp; sleep 5 &amp;amp;&amp;amp; ifup -a --force ; ifconfig&amp;quot;

\## 特别注意：Ubuntu Server重启网络/网卡必须通过 ifdown eth0 &amp;amp;&amp;amp; ifup eth0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;6.）查看Bonding状态&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# cat /proc/net/bonding/bond0 

Ethernet Channel Bonding Driver: v3.7.1 (April 27, 2011)

Bonding Mode: adaptive load balancing
Primary Slave: None
Currently Active Slave: eth1
MII Status: up
MII Polling Interval (ms): 100
Up Delay (ms): 0
Down Delay (ms): 0

Slave Interface: eth0
MII Status: up
Speed: 1000 Mbps
Duplex: full
Link Failure Count: 0
Permanent HW addr: 6c:92:bf:42:05:72
Slave queue ID: 0

Slave Interface: eth1
MII Status: up
Speed: 1000 Mbps
Duplex: full
Link Failure Count: 0
Permanent HW addr: 6c:92:bf:42:05:73
Slave queue ID: 0

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;7.）其他配置方式&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Network bonding with mode 6

# vi /etc/network/interfaces

\# eth0 is manually configured, and slave to the &amp;quot;bond0&amp;quot; bonded NIC
auto eth0
iface eth0 inet manual
bond-master bond0


\# eth1 ditto, thus creating a 2-link bond.
auto eth1
iface eth1 inet manual
bond-master bond0

\# bond0 is the bonding NIC and can be used like any other normal NIC.
\# bond0 is configured using static network information.
auto bond0
iface bond0 inet static
address 192.168.190.129
gateway 192.168.190.1
netmask 255.255.255.0
bond-mode 6 
bond-miimon 100
bond-slaves eth0 eth1

dns-nameserver 114.114.114.114 233.5.5.5
pre-down ifenslave -d bond0 eth0 eth1
post-up ifenslave bond0 eth0 eth1

\# 启动接口（注意启动方式）
# ifup eth0 &amp;amp;&amp;amp; ifup eth1 &amp;amp;&amp;amp; ifup bond0 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;8.）关于Mode&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Mode 0
balance-rr

Mode 1
active-backup

Mode 2
balance-xor

Mode 3
broadcast

Mode 4
802.3ad

Mode 5
balance-tlb

Mode 6
balance-alb

1.The active-backup, balance-tlb and balance-alb modes do not require any specific configuration of the switch.

2.Other bonding modes require configuring the switch to aggregate the links. 
For example, a Cisco switch requires EtherChannel for Modes 0, 2, and 3, but for Mode 4 LACP and EtherChannel are required. 

参考：
https://www.kernel.org/doc/Documentation/networking/bonding.txt

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;9.）参考资料&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;https://help.ubuntu.com/community/UbuntuBonding
https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Networking_Guide/ch-Configure_Network_Bonding.html
http://backdrift.org/lacp-configure-network-bonding-linux
https://www.cyberciti.biz/faq/ubuntu-setup-a-bonding-device-and-enslave-two-real-ethernet-devices/
https://www.cyberciti.biz/faq/ubuntu-linux-bridging-and-bonding-setup/
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>“风花雪月”第一峰</title>
      <link>https://www.zer0d0y.info/post/The-First-Peak-of-Pengcheng/</link>
      <pubDate>Sat, 12 Nov 2016 18:14:42 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/The-First-Peak-of-Pengcheng/</guid>
      <description>

&lt;h5 id=&#34;已然无法记忆下一次是第几十几次登梧桐-鹏城第一峰-梧桐山由于其独特的地理位置-若天公作美-一天内可见-四时之景&#34;&gt;&lt;strong&gt;已然无法记忆下一次是第几十几次登梧桐（鹏城第一峰），梧桐山由于其独特的地理位置，若天公作美，一天内可见&amp;rdquo;四时之景&amp;rdquo;。&lt;/strong&gt;&lt;/h5&gt;

&lt;p&gt;据说大理最有名的景致叫做&lt;strong&gt;“风花雪月”&lt;/strong&gt;——风是“下关风”，下关有天生桥，传说观音在那里打翻了风瓶，所以风大，其实比起北方的朔风，下关风是大大逊色的，但在气候温和的大理尤其是冬天，下关风颇有冷硬的气质。花是“上关花”，传说上关曾盛产奇异的龙女花，到了后来所谓的“花”指的就是上关的女孩子，因为上关、周城现在仍是非常本真的白族居住地，当地人善于制作有名的扎染工艺品，而这一带白族女孩的衣饰也尤为绚丽，宛若鲜花。雪是“苍山雪”，说的是冬天降雪，很少会下到坝子里去，而苍山顶上却会积一簇融融白雪，任天气晴好，山顶的银白也不见消融。月是“洱海月”，黄昏时分，金黄的圆月映照在粼粼的洱海上，岸边的渔家小船轻轻荡漾，温馨无限。一直以来，大理人提到“风花雪月”的典故时，都有一种由热爱而生的微微自豪。&lt;/p&gt;

&lt;p&gt;
&lt;figure &gt;
    
        &lt;img src=&#34;images/first-peak/IMG_7098.JPG&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;images/first-peak/IMG_5423.JPG&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;images/first-peak/IMG_5429.JPG&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;images/first-peak/IMG_8561.JPG&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;images/first-peak/835507268851410138.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;images/first-peak/895362948757392429.jpg&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;figure &gt;
    
        &lt;img src=&#34;images/first-peak/232840252652886495.jpg&#34; /&gt;
    
    
&lt;/figure&gt;
&lt;/p&gt;

&lt;p&gt;&lt;embed src=&#39;https://player.youku.com/player.php/sid/XMjUwOTU0MDI0MA==/v.swf&#39; allowFullScreen=&#39;true&#39; quality=&#39;high&#39; width=&#39;680&#39; height=&#39;600&#39; align=&#39;middle&#39; allowScriptAccess=&#39;always&#39; type=&#39;application/x-shockwave-flash&#39;&gt;&lt;/embed&gt;&lt;/p&gt;

&lt;h2 id=&#34;风雪梧桐山-2016年1月24日&#34;&gt;风雪梧桐山 - 2016年1月24日&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;大自然又一次让我感到了恐惧、无助。&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;帅哥你头低一点，我要拍照。。
慢一点，慢一点，慢一点，把重心放低，一次一步，一次一步，一。。，扑通，前面又有人花式滑冰。。&lt;br /&gt;
He（呵？）。。旁边似乎又有人摔倒，你知道吗，我想拉住他啊，可是我不敢啊，我一动，马上摔倒，一倒马上把前面的人绊倒，你知道当时有多凶险吗，无边的恐惧跟无助从骨子里涌上心头，我麻木了，多年来建立的所有心里防线，全部在瞬间土崩瓦解。谁懂？？？&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;对于未知，请始终保持敬畏！！&lt;/strong&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>墙外的世界</title>
      <link>https://www.zer0d0y.info/post/outdoor_of_FW/</link>
      <pubDate>Wed, 23 Dec 2015 10:48:47 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/outdoor_of_FW/</guid>
      <description>&lt;iframe id=&#34;iframe_container&#34; frameborder=&#34;0&#34; webkitallowfullscreen=&#34;&#34; mozallowfullscreen=&#34;&#34; allowfullscreen=&#34;&#34; width=&#34;550&#34; height=&#34;400&#34; src=&#34;https://prezi.com/embed/reveeovpcfle/?bgcolor=ffffff&amp;amp;lock_to_path=0&amp;amp;autoplay=0&amp;amp;autohide_ctrls=0&amp;amp;landing_data=bHVZZmNaNDBIWnNjdEVENDRhZDFNZGNIUE1JdGtYV3lxSnR0S0o1NUg1ejBVTmZnbFVQNFpGU081Z25UeWtsU0N3PT0&amp;amp;landing_sign=M3IBudY_GchmrbWyJuPpUk0YE_2xjWKvuU63JKQtOvM&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>定制Wireshark profile，自动识别攻击类型</title>
      <link>https://www.zer0d0y.info/post/Wireshark-profiles/</link>
      <pubDate>Fri, 10 Aug 2012 21:10:12 +0800</pubDate>
      
      <guid>https://www.zer0d0y.info/post/Wireshark-profiles/</guid>
      <description>


&lt;figure &gt;
    
        &lt;img src=&#34;images/Wireshark01.png&#34; /&gt;
    
    
&lt;/figure&gt;


&lt;h2 id=&#34;江湖传言-vi-编辑器之神-emacs-神的编辑器-wireshark-协议分析神器&#34;&gt;&lt;strong&gt;江湖传言 ——&lt;/strong&gt; Vi - 编辑器之神，Emacs - 神的编辑器，Wireshark - 协议分析神器。&lt;/h2&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;About Wireshark&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Wireshark is the world’s foremost and widely-used network protocol analyzer.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;About Wireshark Profile&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Configuration Profiles can be used to configure and use more than one set of preferences and configurations. —— &lt;strong&gt;定制配置（捕捉/显示过滤器、颜色规则等），在不同Profile之间快速切换，自动识别攻击类型。（基于定制的规则）&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;定制Wireshark Profile：&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;方法1：
点Edit —— Configuration Profiles  —— New（快捷键Shift-Ctrl-A）&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;方法2：
在Wireshark主窗口下方状态栏右击Profile —— New（或者Manage Profiles）&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;strong&gt;Wireshark Profiles配置文件目录：&lt;/strong&gt;&lt;br /&gt;
Linux&lt;br /&gt;
$HOME/.wireshark/profiles/&lt;br /&gt;
Windows &lt;sup&gt;7&lt;/sup&gt;&amp;frasl;&lt;sub&gt;8&lt;/sub&gt;&lt;br /&gt;
C:\Users&amp;lt;用户名&amp;gt;\AppData\Roaming\Wireshark\profiles&lt;/p&gt;

&lt;p&gt;效果图（右键放大查看）

&lt;figure &gt;
    
        &lt;img src=&#34;images/DNS-Query-flood.png&#34; /&gt;
    
    
&lt;/figure&gt;
&lt;/p&gt;

&lt;p&gt;参考：
&lt;a href=&#34;https://www.wireshark.org/docs/wsug_html_chunked/ChCustConfigProfilesSection.html&#34;&gt;Configuration Profiles&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>